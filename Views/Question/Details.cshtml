@model IEnumerable<Forum_descussion_ASP.NET_core_mvc.Models.ResponseModel>

@{
    ViewData["Title"] = "Details";
    var iduser = ViewData["iduser"];
    var isResolu = ViewData["isResolu"];
    var datecreation = @ViewData["DateCreation"];
    var idquestion = @ViewData["idquestion"];
    var idAuteurQuestion = ViewData["AuteurId"];
    var idSolution = ViewData["idSolution"];
}


@if (iduser.Equals(0))
{
    <partial name="../Shared/Nav_non_connected.cshtml" />
}

else
{
    <partial name="../Shared/Nav_connected.cshtml" />

}

<link rel="stylesheet" href="~/css/question_detail.css" />

<div class="container">
    <main role="main" class="pb-3">

        <h1>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" color="#9a7ce3" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z" />
            </svg>
            <a asp-controller="home" asp-action="Index"> Forum-Discussion</a> > <a asp-action="Index"> Les Questions </a> >Question


        </h1>

        <div class="forum-question1">
            <div class="question-categorie"> Posted in: 

                <a href="/Topic/TopicName?name=@ViewData["Topic"]">
                    @ViewData["Topic"]
                </a>
            </div>
            <h3 class="question-titre">
                
                @ViewData["Titre"] 
                @if (isResolu.Equals(true))
                {
                    <div style="color: green; display: inline;">
                        ( Résolu ) <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" color="green" fill="currentColor" class="bi bi-check-square-fill" viewBox="0 0 16 16">
                            <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z" />
                        </svg> 
                    </div>
                }
            </h3>
            
            <div class="div-corps">
            <div class="left">
                <img class="question-auteur-image" src="/image/@ViewData["Photo"]" />
                <div>

                    <form method="post" action="/Enregistrement/postEnregistrerQuestion">
                        <input type="hidden" name="QuestionId" value="@ViewData["idquestion"]" />
                        <input type="hidden" name="UserId" value="@ViewData["iduser"]" />
                        <button type="submit" class="btn-save">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">
                                <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            <div class="right">
                <div>
                    <div class="question-auteur-nom">  <a href="/Question/LeursQuestions/@ViewData["AuteurId"]"> @ViewData["NameUser"]  </a>  </div>
                    <div class="question-date-creation">
                        @ViewData["DateCreation"]

                    </div>
                </div>

                <div class="question-contenu">
                    @ViewData["Description"]
                </div>
            </div>
            </div>
            
           

          
            <br />
        </div>


    @foreach (var item in Model)
    {
      

    <div class="forum-reponse">


                <div class="div-corps">
                    <div class="left">
                        <img class="reponse-auteur-image" src="/image/@item.User.Photo" />

                            @if (item.UserId.Equals(iduser))
                            {
                                <a class="btn-edit-response" asp-controller="Response" asp-action="Edit" asp-route-id="@item.Id">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
                                        <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
                                    </svg>
                                </a> <br />
                                <a class="btn-delete-response" asp-controller="Response" asp-action="Delete" asp-route-id="@item.Id">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                        <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0" />
                                    </svg>
                                </a>

                            }
                            else
                            {

                                <form method="post" action="/Enregistrement/postEnregistrerReponse">
                                    <input type="hidden" name="QuestionId" value="@ViewData["idquestion"]" />
                                    <input type="hidden" name="ResponseId" value="@item.Id" />
                                    <input type="hidden" name="UserId" value="@ViewData["iduser"]" />
                                    <button type="submit" class="btn-save">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">
                                            <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                                        </svg>
                                    </button>
                                </form>

                            }

                          @if (idSolution.Equals(@item.Id))
                            {

                                if (iduser.Equals(idAuteurQuestion))
                                {
                                    <button onclick="removeBonneReponse()" style="background-color:transparent; border:none; padding:0; margin:0;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" color="green" fill="currentColor" class="bi bi-check-square-fill" viewBox="0 0 16 16">
                                            <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z" />
                                        </svg>
                                    </button>

                                }
                            }

                    </div>


                    <div class="right">
                        <div>
                            <div class="reponse-auteur-nom">  <a href="/Question/LeursQuestions/@item.UserId"> @Html.DisplayFor(modelItem => item.User.NameUser ) </a></div>
                            <div class="reponse-date-creation">  @Html.DisplayFor(modelItem => item.DateCreation , "{0:MM/dd/yyyy}") </div>
                        </div>
                        <div class="reponse-contenu">
                            @Html.DisplayFor(modelItem => item.ResponseContent)
                        </div>
                          @if (idSolution.Equals(0))
                            {
                                if (iduser.Equals(idAuteurQuestion))
                                {
                                <button onclick="choiceBonneReponse(@item.Id)" style="background-color:transparent; border:none; padding:5px; margin:0;" >
                                    Est ce que cette réponse répond à votre question ?
                                </button>
                                }
                            }
                        </div>
                  </div>
  
</div>
     

@*     Impossible d'appliquer l'opérateur '==' aux opérandes de type 'int' et 'object'	  
*@

     
    }

    <div id="createreponse"></div>

        @section Scripts{
            <script>
                function removeBonneReponse() {
                    let text = "Cette réponse n'est pas la bonne ?";
                    if (confirm(text) == true) {
                        document.location.href = "/Question/removeQuestionResolu?idQuestion=@ViewData["idquestion"]";
                    }
                }

                function choiceBonneReponse(id ) {
                    let text = "Cette réponse n'est pas la bonne ?";
                    if (confirm(text) == true) {
                        document.location.href = "/Question/addQuestionResolu?idQuestion=@ViewData["idquestion"]&idResponseSolution="+id;
                    }
                }


                $('#updatereponse').hide();
                $('#updatereponse').load("/Response/Edit?id=" + @idquestion)

                $('#createreponse').load("/Response/Create?id=" + @idquestion)
            </script>
        }
       
        </br></br></br></br></br>
       

    </main></div>